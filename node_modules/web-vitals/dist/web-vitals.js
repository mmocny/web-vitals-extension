var e=function(e,t){return{name:e,value:void 0===t?-1:t,delta:0,entries:[],id:"v1-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},t=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var n=new PerformanceObserver((function(e){return e.getEntries().map(t)}));return n.observe({type:e,buffered:!0}),n}}catch(e){}},n=!1,r=function(e,t){n||"undefined"!=typeof InstallTrigger||(addEventListener("beforeunload",(function(){})),n=!0);addEventListener("visibilitychange",(function n(r){"hidden"===document.visibilityState&&(e(r),t&&removeEventListener("visibilitychange",n,!0))}),!0)},i=function(e){addEventListener("pageshow",(function(t){t.persisted&&e(t)}),!0)};function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l,v,d,h,y="function"==typeof WeakSet?new WeakSet:new Set,g=function(e,t,n){var r=Array.isArray(t)?t:[t],i=m(Array(r.length));return function(){r.map((function(e,t){return!!(e.value>=0&&(n||y.has(r[t])||"hidden"===document.visibilityState)&&(e.delta=e.value-(i[t]||0),e.delta||void 0===i[t]))&&(i[t]=e.value,!0)})).includes(!0)&&(Array.isArray(t)?e(t.reduce((function(e,n,r){return f(f({},e),{},u({},n.name,t[r]))}),{})):e(t))}},S=function(n,a){var o,s=e("CLS",0),u=function(e){e.hadRecentInput||(s.value+=e.value,s.entries.push(e),o())},c=t("layout-shift",u);c&&(o=g(n,s,a),r((function(){c.takeRecords().map(u),o()})),i((function(){s=e("CLS",0),o=g(n,s,a)})))},b=-1,w=function(){return"hidden"===document.visibilityState?0:1/0},T=function(){r((function(e){var t=e.timeStamp;b=t}),!0)},E=function(){return b<0&&(b=w(),T(),i((function(){setTimeout((function(){b=w(),T()}),0)}))),{get timeStamp(){return b}}},N=function(n,r){var a,o=E(),s=e("FCP"),u=t("paint",(function(e){"first-contentful-paint"===e.name&&(u&&u.disconnect(),e.startTime<o.timeStamp&&(s.value=e.startTime,s.entries.push(e),y.add(s),a()))}));u&&(a=g(n,s,r),i((function(t){s=e("FCP"),a=g(n,s,r),requestAnimationFrame((function(){requestAnimationFrame((function(){s.value=performance.now()-t.timeStamp,y.add(s),a()}))}))})))},O={passive:!0,capture:!0},I=new Date,L=function(e,t){l||(l=t,v=e,d=new Date,P(removeEventListener),_())},_=function(){if(v>=0&&v<d-I){var e={entryType:"first-input",name:l.type,target:l.target,cancelable:l.cancelable,startTime:l.timeStamp,processingStart:l.timeStamp+v};h.forEach((function(t){t(e)})),h=[]}},A=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){L(e,t),i()},r=function(){i()},i=function(){removeEventListener("pointerup",n,O),removeEventListener("pointercancel",r,O)};addEventListener("pointerup",n,O),addEventListener("pointercancel",r,O)}(t,e):L(t,e)}},P=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,A,O)}))},j=function(n,a){var o,s=E(),u=e("FID"),c=function(e){e.startTime<s.timeStamp&&(u.value=e.processingStart-e.startTime,u.entries.push(e),y.add(u),o())},f=t("first-input",c);o=g(n,u,a),f&&r((function(){f.takeRecords().map(c),f.disconnect()}),!0),f&&i((function(){var t;u=e("FID"),o=g(n,u,a),h=[],v=-1,l=null,P(addEventListener),t=c,h.push(t),_()}))},x=function(n,a){var o,s=E(),u=e("LCP"),c=function(e){var t=e.startTime;t<s.timeStamp&&(u.value=t,u.entries.push(e)),o()},f=t("largest-contentful-paint",c);if(f){o=g(n,u,a);var m=function(){y.has(u)||(f.takeRecords().map(c),f.disconnect(),y.add(u),o())};["keydown","click"].forEach((function(e){addEventListener(e,m,{once:!0,capture:!0})})),r(m,!0),i((function(t){u=e("LCP"),o=g(n,u,a),requestAnimationFrame((function(){requestAnimationFrame((function(){u.value=performance.now()-t.timeStamp,y.add(u),o()}))}))}))}},k=function(t){var n,r=e("TTFB");n=function(){try{var e=performance.getEntriesByType("navigation")[0]||function(){var e=performance.timing,t={entryType:"navigation",startTime:0};for(var n in e)"navigationStart"!==n&&"toJSON"!==n&&(t[n]=Math.max(e[n]-e.navigationStart,0));return t}();r.value=r.delta=e.responseStart,r.entries=[e],t(r)}catch(e){}},"complete"===document.readyState?setTimeout(n,0):addEventListener("pageshow",n)},F=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;a(this,e),this.firstTs_=Number.NEGATIVE_INFINITY,this.prevTs_=Number.NEGATIVE_INFINITY,this.score_=0,this.gap_=t,this.limit_=n}return s(e,[{key:"addShift",value:function(e){var t={isNew:!1,score:0};return(e.startTime-this.prevTs_>this.gap_||e.startTime-this.firstTs_>this.limit_)&&(this.firstTs_=e.startTime,this.score_=0,t.isNew=!0),this.prevTs_=e.startTime,this.score_+=e.value,t.score=this.score_,t}}]),e}(),D=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;a(this,e),this.limit_=t}return s(e,[{key:"addShift",value:function(e){for(var t=0,n=e[e.length-1].startTime,r=e.length-1;r>=0;r--){if(n-e[r].startTime>this.limit_)return t;t+=e[r].value}return t}}]),e}(),C=function(n,a){var o,s=new F(5e3),u=new F(1e3),c=new F(1e3,5e3),f=new D(1e3),m=new D(300),p=0,l=0,v=e("LSN-avg-session-gap5s",0),d=e("LSN-max-session-gap1s",0),h=e("LSN-max-session-gap1s-limit5s",0),y=e("LSN-max-sliding1s",0),S=e("LSN-max-sliding-300ms",0),b=function(e){if(!e.hadRecentInput){v.entries.push(e),d.entries.push(e),h.entries.push(e),y.entries.push(e),S.entries.push(e);var t=s.addShift(e).isNew;p+=e.value,t&&l++,v.value=p/l,d.value=Math.max(d.value,u.addShift(e).score),h.value=Math.max(h.value,c.addShift(e).score),y.value=Math.max(y.value,f.addShift(y.entries)),S.value=Math.max(S.value,m.addShift(S.entries)),o()}},w=t("layout-shift",b);w&&(o=g(n,[v,d,h,y,S],a),r((function(){w.takeRecords().map(b),o()})),i((function(){v=e("LSN-avg-session-gap5s",0),d=e("LSN-max-session-gap1s",0),h=e("LSN-max-session-gap1s-limit5s",0),y=e("LSN-max-sliding1s",0),S=e("LSN-max-sliding-300ms",0),o=g(n,[v,d,h,y,S],a)})))};export{S as getCLS,N as getFCP,j as getFID,x as getLCP,C as getLSN,k as getTTFB};
