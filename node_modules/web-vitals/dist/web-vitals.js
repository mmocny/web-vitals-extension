var t=function(t,e){return{name:t,value:void 0===e?-1:e,delta:0,entries:[],id:"v1-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},e=function(t,e){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var n=new PerformanceObserver((function(t){return t.getEntries().map(e)}));return n.observe({type:t,buffered:!0}),n}}catch(t){}},n=!1,r=function(t,e){n||"undefined"!=typeof InstallTrigger||(addEventListener("beforeunload",(function(){})),n=!0);addEventListener("visibilitychange",(function n(r){"hidden"===document.visibilityState&&(t(r),e&&removeEventListener("visibilitychange",n,!0))}),!0)},i=function(t){addEventListener("pageshow",(function(e){e.persisted&&t(e)}),!0)};function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function m(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var l,v,d,h,y="function"==typeof WeakSet?new WeakSet:new Set,S=function(t,e,n){var r=Array.isArray(e)?e:[e],i=m(Array(r.length));return function(){r.map((function(t,e){return!!(t.value>=0&&(n||y.has(r[e])||"hidden"===document.visibilityState)&&(t.delta=t.value-(i[e]||0),t.delta||void 0===i[e]))&&(i[e]=t.value,!0)})).includes(!0)&&(Array.isArray(e)?t(e.reduce((function(t,n,r){return f(f({},t),{},u({},n.name,e[r]))}),{})):t(e))}},g=function(n,a){var o,s=t("CLS",0),u=function(t){t.hadRecentInput||(s.value+=t.value,s.entries.push(t),o())},c=e("layout-shift",u);c&&(o=S(n,s,a),r((function(){c.takeRecords().map(u),o()})),i((function(){s=t("CLS",0),o=S(n,s,a)})))},b=-1,w=function(){return"hidden"===document.visibilityState?0:1/0},T=function(){r((function(t){var e=t.timeStamp;b=e}),!0)},O=function(){return b<0&&(b=w(),T(),i((function(){setTimeout((function(){b=w(),T()}),0)}))),{get timeStamp(){return b}}},L=function(n,r){var a,o=O(),s=t("FCP"),u=e("paint",(function(t){"first-contentful-paint"===t.name&&(u&&u.disconnect(),t.startTime<o.timeStamp&&(s.value=t.startTime,s.entries.push(t),y.add(s),a()))}));u&&(a=S(n,s,r),i((function(e){s=t("FCP"),a=S(n,s,r),requestAnimationFrame((function(){requestAnimationFrame((function(){s.value=performance.now()-e.timeStamp,y.add(s),a()}))}))})))},_={passive:!0,capture:!0},E=new Date,I=function(t,e){l||(l=e,v=t,d=new Date,N(removeEventListener),P())},P=function(){if(v>=0&&v<d-E){var t={entryType:"first-input",name:l.type,target:l.target,cancelable:l.cancelable,startTime:l.timeStamp,processingStart:l.timeStamp+v};h.forEach((function(e){e(t)})),h=[]}},j=function(t){if(t.cancelable){var e=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,e){var n=function(){I(t,e),i()},r=function(){i()},i=function(){removeEventListener("pointerup",n,_),removeEventListener("pointercancel",r,_)};addEventListener("pointerup",n,_),addEventListener("pointercancel",r,_)}(e,t):I(e,t)}},N=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach((function(e){return t(e,j,_)}))},A=function(n,a){var o,s=O(),u=t("FID"),c=function(t){t.startTime<s.timeStamp&&(u.value=t.processingStart-t.startTime,u.entries.push(t),y.add(u),o())},f=e("first-input",c);o=S(n,u,a),f&&r((function(){f.takeRecords().map(c),f.disconnect()}),!0),f&&i((function(){var e;u=t("FID"),o=S(n,u,a),h=[],v=-1,l=null,N(addEventListener),e=c,h.push(e),P()}))},x=function(n,a){var o,s=O(),u=t("LCP"),c=function(t){var e=t.startTime;e<s.timeStamp&&(u.value=e,u.entries.push(t)),o()},f=e("largest-contentful-paint",c);if(f){o=S(n,u,a);var m=function(){y.has(u)||(f.takeRecords().map(c),f.disconnect(),y.add(u),o())};["keydown","click"].forEach((function(t){addEventListener(t,m,{once:!0,capture:!0})})),r(m,!0),i((function(e){u=t("LCP"),o=S(n,u,a),requestAnimationFrame((function(){requestAnimationFrame((function(){u.value=performance.now()-e.timeStamp,y.add(u),o()}))}))}))}},k=function(e){var n,r=t("TTFB");n=function(){try{var t=performance.getEntriesByType("navigation")[0]||function(){var t=performance.timing,e={entryType:"navigation",startTime:0};for(var n in t)"navigationStart"!==n&&"toJSON"!==n&&(e[n]=Math.max(t[n]-t.navigationStart,0));return e}();r.value=r.delta=t.responseStart,r.entries=[t],e(r)}catch(t){}},"complete"===document.readyState?setTimeout(n,0):addEventListener("pageshow",n)},F=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;a(this,t),this.firstTs_=0,this.prevTs_=0,this.score_=0,this.gap_=e,this.limit_=n}return s(t,[{key:"addShift",value:function(t){var e=0;return(t.startTime-this.prevTs_>this.gap_||t.startTime-this.firstTs_>this.limit_)&&(e=this.score_,this.firstTs_=t.startTime,this.score_=0),this.prevTs_=t.startTime,this.score_+=t.value,{prevScore:e,score:this.score_}}}]),t}(),D=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;a(this,t),this.shifts_=[],this.limit_=e}return s(t,[{key:"addShift",value:function(t){for(;this.shifts_.length&&t.startTime-this.shifts_[0].startTime>this.limit_;)this.shifts_.shift();return this.shifts_.push(t),this.shifts_.reduce((function(t,e){return t+e.value}),0)}}]),t}(),C=function(n,a){var o,s=new F(5e3),u=new F(1e3),c=new F(1e3,5e3),f=new D(1e3),m=new D(300),p=0,l=0,v=t("LSN-avg-session-gap5s",0),d=t("LSN-max-session-gap1s",0),h=t("LSN-max-session-gap1s-limit5s",0),y=t("LSN-max-sliding1s",0),g=t("LSN-max-sliding-300ms",0),b=function(t){if(!t.hadRecentInput){v.entries.push(t),d.entries.push(t),h.entries.push(t),y.entries.push(t),g.entries.push(t);var e=s.addShift(t),n=e.prevScore,r=e.score;n&&(p+=n,l++),v.value=(p+r)/(l+1),d.value=Math.max(d.value,u.addShift(t).score),h.value=Math.max(h.value,c.addShift(t).score),y.value=Math.max(y.value,f.addShift(t)),g.value=Math.max(g.value,m.addShift(t)),o()}},w=e("layout-shift",b);w&&(o=S(n,[v,d,h,y,g],a),r((function(){w.takeRecords().map(b),o()})),i((function(){v=t("LSN-avg-session-gap5s",0),d=t("LSN-max-session-gap1s",0),h=t("LSN-max-session-gap1s-limit5s",0),y=t("LSN-max-sliding1s",0),g=t("LSN-max-sliding-300ms",0),o=S(n,[v,d,h,y,g],a)})))};export{g as getCLS,L as getFCP,A as getFID,x as getLCP,C as getLSN,k as getTTFB};
